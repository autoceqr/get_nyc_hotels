function InfoBox(t){t=t||{},google.maps.OverlayView.apply(this,arguments),this.content_=t.content||"",this.disableAutoPan_=t.disableAutoPan||!1,this.maxWidth_=t.maxWidth||0,this.pixelOffset_=t.pixelOffset||new google.maps.Size(0,0),this.position_=t.position||new google.maps.LatLng(0,0),this.zIndex_=t.zIndex||null,this.boxClass_=t.boxClass||"infobox",this.boxStyle_=t.boxStyle||{},this.closeBoxMargin_=t.closeBoxMargin||"2px",this.closeBoxURL_=t.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",""===t.closeBoxURL&&(this.closeBoxURL_=""),this.infoBoxClearance_=t.infoBoxClearance||new google.maps.Size(1,1),void 0===t.visible&&(void 0===t.isHidden?t.visible=!0:t.visible=!t.isHidden),this.isHidden_=!t.visible,this.alignBottom_=t.alignBottom||!1,this.pane_=t.pane||"floatPane",this.enableEventPropagation_=t.enableEventPropagation||!1,this.div_=null,this.closeListener_=null,this.moveListener_=null,this.contextListener_=null,this.eventListeners_=null,this.fixedWidthSet_=null}InfoBox.prototype=new google.maps.OverlayView,InfoBox.prototype.createInfoBoxDiv_=function(){function e(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()}var t,i,o,s=this;if(!this.div_){if(this.div_=document.createElement("div"),this.setBoxStyle_(),void 0===this.content_.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+this.content_:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(this.content_)),this.getPanes()[this.pane_].appendChild(this.div_),this.addClickHandler_(),this.div_.style.width?this.fixedWidthSet_=!0:0!==this.maxWidth_&&this.div_.offsetWidth>this.maxWidth_?(this.div_.style.width=this.maxWidth_,this.div_.style.overflow="auto",this.fixedWidthSet_=!0):(o=this.getBoxWidths_(),this.div_.style.width=this.div_.offsetWidth-o.left-o.right+"px",this.fixedWidthSet_=!1),this.panBox_(this.disableAutoPan_),!this.enableEventPropagation_){for(this.eventListeners_=[],i=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],t=0;t<i.length;t++)this.eventListeners_.push(google.maps.event.addDomListener(this.div_,i[t],e));this.eventListeners_.push(google.maps.event.addDomListener(this.div_,"mouseover",function(t){this.style.cursor="default"}))}this.contextListener_=google.maps.event.addDomListener(this.div_,"contextmenu",function(t){t.returnValue=!1,t.preventDefault&&t.preventDefault(),s.enableEventPropagation_||e(t)}),google.maps.event.trigger(this,"domready")}},InfoBox.prototype.getCloseBoxImg_=function(){var t="";return""!==this.closeBoxURL_&&(t="<img",t+=" src='"+this.closeBoxURL_+"'",t+=" align=right",t+=" style='",t+=" position: relative;",t+=" cursor: pointer;",t+=" margin: "+this.closeBoxMargin_+";",t+="'>"),t},InfoBox.prototype.addClickHandler_=function(){var t;""!==this.closeBoxURL_?(t=this.div_.firstChild,this.closeListener_=google.maps.event.addDomListener(t,"click",this.getCloseClickHandler_())):this.closeListener_=null},InfoBox.prototype.getCloseClickHandler_=function(){var e=this;return function(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation(),google.maps.event.trigger(e,"closeclick"),e.close()}},InfoBox.prototype.panBox_=function(t){var e,i=0,o=0;if(!t&&(e=this.getMap())instanceof google.maps.Map){e.getBounds().contains(this.position_)||e.setCenter(this.position_),e.getBounds();var s=e.getDiv(),n=s.offsetWidth,r=s.offsetHeight,h=this.pixelOffset_.width,a=this.pixelOffset_.height,l=this.div_.offsetWidth,d=this.div_.offsetHeight,p=this.infoBoxClearance_.width,g=this.infoBoxClearance_.height,c=this.getProjection().fromLatLngToContainerPixel(this.position_);if(c.x<-h+p?i=c.x+h-p:c.x+l+h+p>n&&(i=c.x+l+h+p-n),this.alignBottom_?c.y<-a+g+d?o=c.y+a-g-d:c.y+a+g>r&&(o=c.y+a+g-r):c.y<-a+g?o=c.y+a-g:c.y+d+a+g>r&&(o=c.y+d+a+g-r),0!==i||0!==o){e.getCenter();e.panBy(i,o)}}},InfoBox.prototype.setBoxStyle_=function(){var t,e;if(this.div_){for(t in this.div_.className=this.boxClass_,this.div_.style.cssText="",e=this.boxStyle_)e.hasOwnProperty(t)&&(this.div_.style[t]=e[t]);this.div_.style.WebkitTransform="translateZ(0)",void 0!==this.div_.style.opacity&&""!==this.div_.style.opacity&&(this.div_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+100*this.div_.style.opacity+')"',this.div_.style.filter="alpha(opacity="+100*this.div_.style.opacity+")"),this.div_.style.position="absolute",this.div_.style.visibility="hidden",null!==this.zIndex_&&(this.div_.style.zIndex=this.zIndex_)}},InfoBox.prototype.getBoxWidths_=function(){var t,e={top:0,bottom:0,left:0,right:0},i=this.div_;return document.defaultView&&document.defaultView.getComputedStyle?(t=i.ownerDocument.defaultView.getComputedStyle(i,""))&&(e.top=parseInt(t.borderTopWidth,10)||0,e.bottom=parseInt(t.borderBottomWidth,10)||0,e.left=parseInt(t.borderLeftWidth,10)||0,e.right=parseInt(t.borderRightWidth,10)||0):document.documentElement.currentStyle&&i.currentStyle&&(e.top=parseInt(i.currentStyle.borderTopWidth,10)||0,e.bottom=parseInt(i.currentStyle.borderBottomWidth,10)||0,e.left=parseInt(i.currentStyle.borderLeftWidth,10)||0,e.right=parseInt(i.currentStyle.borderRightWidth,10)||0),e},InfoBox.prototype.onRemove=function(){this.div_&&(this.div_.parentNode.removeChild(this.div_),this.div_=null)},InfoBox.prototype.draw=function(){this.createInfoBoxDiv_();var t=this.getProjection().fromLatLngToDivPixel(this.position_);this.div_.style.left=t.x+this.pixelOffset_.width+"px",this.alignBottom_?this.div_.style.bottom=-(t.y+this.pixelOffset_.height)+"px":this.div_.style.top=t.y+this.pixelOffset_.height+"px",this.isHidden_?this.div_.style.visibility="hidden":this.div_.style.visibility="visible"},InfoBox.prototype.setOptions=function(t){void 0!==t.boxClass&&(this.boxClass_=t.boxClass,this.setBoxStyle_()),void 0!==t.boxStyle&&(this.boxStyle_=t.boxStyle,this.setBoxStyle_()),void 0!==t.content&&this.setContent(t.content),void 0!==t.disableAutoPan&&(this.disableAutoPan_=t.disableAutoPan),void 0!==t.maxWidth&&(this.maxWidth_=t.maxWidth),void 0!==t.pixelOffset&&(this.pixelOffset_=t.pixelOffset),void 0!==t.alignBottom&&(this.alignBottom_=t.alignBottom),void 0!==t.position&&this.setPosition(t.position),void 0!==t.zIndex&&this.setZIndex(t.zIndex),void 0!==t.closeBoxMargin&&(this.closeBoxMargin_=t.closeBoxMargin),void 0!==t.closeBoxURL&&(this.closeBoxURL_=t.closeBoxURL),void 0!==t.infoBoxClearance&&(this.infoBoxClearance_=t.infoBoxClearance),void 0!==t.isHidden&&(this.isHidden_=t.isHidden),void 0!==t.visible&&(this.isHidden_=!t.visible),void 0!==t.enableEventPropagation&&(this.enableEventPropagation_=t.enableEventPropagation),this.div_&&this.draw()},InfoBox.prototype.setContent=function(t){this.content_=t,this.div_&&(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.fixedWidthSet_||(this.div_.style.width=""),void 0===t.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+t:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(t)),this.fixedWidthSet_||(this.div_.style.width=this.div_.offsetWidth+"px",void 0===t.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+t:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(t))),this.addClickHandler_()),google.maps.event.trigger(this,"content_changed")},InfoBox.prototype.setPosition=function(t){this.position_=t,this.div_&&this.draw(),google.maps.event.trigger(this,"position_changed")},InfoBox.prototype.setZIndex=function(t){this.zIndex_=t,this.div_&&(this.div_.style.zIndex=t),google.maps.event.trigger(this,"zindex_changed")},InfoBox.prototype.setVisible=function(t){this.isHidden_=!t,this.div_&&(this.div_.style.visibility=this.isHidden_?"hidden":"visible")},InfoBox.prototype.getContent=function(){return this.content_},InfoBox.prototype.getPosition=function(){return this.position_},InfoBox.prototype.getZIndex=function(){return this.zIndex_},InfoBox.prototype.getVisible=function(){return void 0!==this.getMap()&&null!==this.getMap()&&!this.isHidden_},InfoBox.prototype.show=function(){this.isHidden_=!1,this.div_&&(this.div_.style.visibility="visible")},InfoBox.prototype.hide=function(){this.isHidden_=!0,this.div_&&(this.div_.style.visibility="hidden")},InfoBox.prototype.open=function(t,e){var i=this;e&&(this.position_=e.getPosition(),this.moveListener_=google.maps.event.addListener(e,"position_changed",function(){i.setPosition(this.getPosition())})),this.setMap(t),this.div_&&this.panBox_()},InfoBox.prototype.close=function(){var t;if(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.eventListeners_){for(t=0;t<this.eventListeners_.length;t++)google.maps.event.removeListener(this.eventListeners_[t]);this.eventListeners_=null}this.moveListener_&&(google.maps.event.removeListener(this.moveListener_),this.moveListener_=null),this.contextListener_&&(google.maps.event.removeListener(this.contextListener_),this.contextListener_=null),this.setMap(null)},function(){var o=!0,s=!1;function t(t){var e=t||{};this.d=this.c=s,null==t.visible&&(t.visible=o),null==t.shadow&&(t.shadow="7px -3px 5px rgba(88,88,88,0.7)"),null==t.anchor&&(t.anchor=l.BOTTOM),this.setValues(e)}function n(t,e){if(t.c){var i="";-1!==navigator.userAgent.indexOf("Gecko/")?("dragging"==e&&(i="-moz-grabbing"),"dragready"==e&&(i="-moz-grab")):"dragging"!=e&&"dragready"!=e||(i="move"),"draggable"==e&&(i="pointer"),t.a.style.cursor!=i&&(t.a.style.cursor=i)}}function r(t){t.getDraggable()&&t.d&&(t.d=s,t.getMap().set("draggable",t.m),t.h=t.i=t.m=null,t.a.style.MozUserSelect="",t.a.style.KhtmlUserSelect="",t.a.style.WebkitUserSelect="",t.a.unselectable="off",t.a.onselectstart=function(){},function(t){if(t.e){for(var e,i=0;e=t.e[i];i++)google.maps.event.removeListener(e);t.e.length=0}}(t),n(t,"draggable"),google.maps.event.trigger(t,"dragend"),t.draw())}function h(t,e){if(t.getDraggable()&&t.d){var i=t.h-e.clientX,o=t.i-e.clientY;t.h=e.clientX,t.i=e.clientY,i=parseInt(t.a.style.left,10)-i,o=parseInt(t.a.style.top,10)-o,t.a.style.left=i+"px",t.a.style.top=o+"px";var s=a(t);t.setPosition(t.getProjection().fromDivPixelToLatLng(new google.maps.Point(i-s.width,o-s.height))),n(t,"dragging"),google.maps.event.trigger(t,"drag")}else r(t)}function e(t){t.f&&(google.maps.event.removeListener(t.f),delete t.f),n(t,"")}function a(t){var e=t.l();if("object"==typeof e)return e;var i=new google.maps.Size(0,0);if(!t.b)return i;var o=t.b.offsetWidth;switch(t=t.b.offsetHeight,e){case l.TOP:i.width=-o/2;break;case l.TOP_RIGHT:i.width=-o;break;case l.LEFT:i.height=-t/2;break;case l.MIDDLE:i.width=-o/2,i.height=-t/2;break;case l.RIGHT:i.width=-o,i.height=-t/2;break;case l.BOTTOM_LEFT:i.height=-t;break;case l.BOTTOM:i.width=-o/2,i.height=-t;break;case l.BOTTOM_RIGHT:i.width=-o,i.height=-t}return i}t.prototype=new google.maps.OverlayView,(window.RichMarker=t).prototype.getVisible=t.prototype.getVisible=function(){return this.get("visible")},t.prototype.setVisible=t.prototype.setVisible=function(t){this.set("visible",t)},t.prototype.visible_changed=t.prototype.s=function(){this.c&&(this.a.style.display=this.getVisible()?"":"none",this.draw())},t.prototype.setFlat=t.prototype.setFlat=function(t){this.set("flat",!!t)},t.prototype.getFlat=t.prototype.getFlat=function(){return this.get("flat")},t.prototype.getWidth=t.prototype.p=function(){return this.get("width")},t.prototype.getHeight=t.prototype.o=function(){return this.get("height")},t.prototype.setShadow=t.prototype.setShadow=function(t){this.set("shadow",t),this.g()},t.prototype.getShadow=t.prototype.getShadow=function(){return this.get("shadow")},t.prototype.flat_changed=t.prototype.g=function(){this.c&&(this.a.style.boxShadow=this.a.style.webkitBoxShadow=this.a.style.MozBoxShadow=this.getFlat()?"":this.getShadow())},t.prototype.setZIndex=t.prototype.setZIndex=function(t){this.set("zIndex",t)},t.prototype.getZIndex=t.prototype.getZIndex=function(){return this.get("zIndex")},t.prototype.zIndex_changed=t.prototype.t=function(){this.getZIndex()&&this.c&&(this.a.style.zIndex=this.getZIndex())},t.prototype.getDraggable=t.prototype.getDraggable=function(){return this.get("draggable")},t.prototype.setDraggable=t.prototype.setDraggable=function(t){this.set("draggable",!!t)},t.prototype.draggable_changed=t.prototype.k=function(){this.c&&(this.getDraggable()?function(e,t){t&&(e.f=google.maps.event.addDomListener(t,"mousedown",function(t){!function(t,e){if(t.getDraggable()&&!t.d){t.d=o;var i=t.getMap();t.m=i.get("draggable"),i.set("draggable",s),t.h=e.clientX,t.i=e.clientY,n(t,"dragready"),t.a.style.MozUserSelect="none",t.a.style.KhtmlUserSelect="none",t.a.style.WebkitUserSelect="none",t.a.unselectable="on",t.a.onselectstart=function(){return s},function(e){e.a.setCapture?(e.a.setCapture(o),e.e=[google.maps.event.addDomListener(e.a,"mousemove",function(t){h(e,t)},o),google.maps.event.addDomListener(e.a,"mouseup",function(){r(e),e.a.releaseCapture()},o)]):e.e=[google.maps.event.addDomListener(window,"mousemove",function(t){h(e,t)},o),google.maps.event.addDomListener(window,"mouseup",function(){r(e)},o)]}(t),google.maps.event.trigger(t,"dragstart")}}(e,t)}),n(e,"draggable"))}(this,this.a):e(this))},t.prototype.getPosition=t.prototype.getPosition=function(){return this.get("position")},t.prototype.setPosition=t.prototype.setPosition=function(t){this.set("position",t)},t.prototype.position_changed=t.prototype.q=function(){this.draw()},t.prototype.getAnchor=t.prototype.l=function(){return this.get("anchor")},t.prototype.setAnchor=t.prototype.r=function(t){this.set("anchor",t)},t.prototype.anchor_changed=t.prototype.n=function(){this.draw()},t.prototype.setContent=t.prototype.setContent=function(t){this.set("content",t)},t.prototype.getContent=t.prototype.getContent=function(){return this.get("content")},t.prototype.content_changed=t.prototype.j=function(){if(this.b){!function(t,e){if(e)for(var i;i=e.firstChild;)e.removeChild(i)}(0,this.b);var t=this.getContent();if(t){"string"==typeof t&&(t=function(t,e){var i=document.createElement("DIV");if(i.innerHTML=e,1==i.childNodes.length)return i.removeChild(i.firstChild);for(var o=document.createDocumentFragment();i.firstChild;)o.appendChild(i.firstChild);return o}(0,t=t.replace(/^\s*([\S\s]*)\b\s*$/,"$1"))),this.b.appendChild(t);var e=this;t=this.b.getElementsByTagName("IMG");for(var i,o=0;i=t[o];o++)google.maps.event.addDomListener(i,"mousedown",function(t){e.getDraggable()&&(t.preventDefault&&t.preventDefault(),t.returnValue=s)}),google.maps.event.addDomListener(i,"load",function(){e.draw()});google.maps.event.trigger(this,"domready")}this.c&&this.draw()}},t.prototype.onAdd=t.prototype.onAdd=function(){if(this.a||(this.a=document.createElement("DIV"),this.a.style.position="absolute"),this.getZIndex()&&(this.a.style.zIndex=this.getZIndex()),this.a.style.display=this.getVisible()?"":"none",!this.b){this.b=document.createElement("DIV"),this.a.appendChild(this.b);var t=this;google.maps.event.addDomListener(this.b,"click",function(){google.maps.event.trigger(t,"click")}),google.maps.event.addDomListener(this.b,"mouseover",function(){google.maps.event.trigger(t,"mouseover")}),google.maps.event.addDomListener(this.b,"mouseout",function(){google.maps.event.trigger(t,"mouseout")})}this.c=o,this.j(),this.g(),this.k();var e=this.getPanes();e&&e.overlayImage.appendChild(this.a),google.maps.event.trigger(this,"ready")},t.prototype.draw=t.prototype.draw=function(){if(this.c&&!this.d){var t=this.getProjection();if(t){var e=this.get("position");t=t.fromLatLngToDivPixel(e),e=a(this),this.a.style.top=t.y+e.height+"px",this.a.style.left=t.x+e.width+"px",t=this.b.offsetHeight,(e=this.b.offsetWidth)!=this.get("width")&&this.set("width",e),t!=this.get("height")&&this.set("height",t)}}},t.prototype.onRemove=t.prototype.onRemove=function(){this.a&&this.a.parentNode&&this.a.parentNode.removeChild(this.a),e(this)};var l={TOP_LEFT:1,TOP:2,TOP_RIGHT:3,LEFT:4,MIDDLE:5,RIGHT:6,BOTTOM_LEFT:7,BOTTOM:8,BOTTOM_RIGHT:9};window.RichMarkerPosition=l}();